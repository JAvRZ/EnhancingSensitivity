# EnhancingSensitivity
This repository contains the code for the simulation studies that were performed in "Enhancing Sensitivity of Neuropsychological Assessment: Multivariate Normative Comparisons Using an Aggregated Database"

This repository contains:
This readme-file
Three R code files that can be used to simulate and analyze data
Two missing data pattern files.

The simulation setup file is used to generate data that resembles neuropsychological norm data from multiple studies.
This data therefore has a multilevel structure. Also, data might be missing, as not studies may have administered all tests.
To simulate this, data were removed according to a prespecified pattern. 
The patterns are also uploaded, in the 40missingstructure and 70missingstructure files.
Like with the rest of the R code files, the working directory specification should be adapted to the directory structure of the user,
specifically, the following lines in the simulation setup files:
main.working.directory <- paste( "C:/Users/jagelin1/Documents/MMNC/FinalSims/sims", type, percentage.missing, "missing", sep = "")
missing.structure.working.directory <- "C:/Users/jagelin1/Documents/MMNC/MissingStructures"

The patient setup file is very similar to the file used to simulate normative data. This code generates simulated data for a single participant.
This single participant may be a patient, with a deviating score on one or more tests, or may be a healthy individual, who scores like the normative group.
The former situation allows us to study sensitivity, the latter situation allows us to study susceptibility to false positives.

The connecting norm and patient file is used to combine the normative data as generated with the simulations setup file
with the patient data as generated by the patient setup file. This code runs the multilevel multivariate model described in the article,
and performs normative comparisons. 

A word of warning: The model fitting code is not fast. We have used the nlme package, which is
slower than the lme4 package that is usually used for multilevel modeling. The reason we needed the nlme package is that it allowed us to model the within
study covariance in the way we wanted. This requires time, and the thousands of simulations that have been performed for the article took weeks rather than minutes.

Any questions, suggestions or problems with the code that you experience can be entered via GitHub, or can be mailed to joostzandvliet at gmail dot com (which might get a faster response). 
